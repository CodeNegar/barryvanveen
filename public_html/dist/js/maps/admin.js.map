{"version":3,"sources":["autosize.js","ajaxq.js","admin.js"],"names":["root","factory","define","amd","exports","module","autosize","this","main","ta","init","style","window","getComputedStyle","resize","wordWrap","width","offsetWidth","maxHeight","parseFloat","heightOffset","boxSizing","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","adjust","startHeight","height","htmlTop","document","documentElement","scrollTop","bodyTop","body","endHeight","scrollHeight","overflowY","evt","createEvent","initEvent","dispatchEvent","nodeName","hasAttribute","addEventListener","removeEventListener","Object","keys","forEach","key","removeAttribute","bind","overflow","setAttribute","elements","length","Array","prototype","call","require","jQuery","$","queues","activeReqs","ajaxq","qname","opts","enqueue","cb","push","xhr","dequeue","nextCallback","shift","deferred","Deferred","promise","success","done","error","fail","complete","always","deferredOpts","clonedOptions","extend","jqXHR","ajax","apply","resolve","arguments","reject","each","i","method","url","data","callback","type","isFunction","undefined","dataType","isQueueRunning","hasOwnProperty","isAnyQueueRunning","isRunning","getActiveRequest","abort","current","clear","Barryvanveen","admin","callTimer","initClickableTableRows","initAutosizeTextareas","initMarkdownEditors","initLogModal","mousedown","e","preventDefault","which","win","open","focus","location","abortPostQueue","queue","MarkdownEditor","element","$input","$preview","name","inputname","attr","updateMarkdownEditor","clearTimeout","setTimeout","postq","markdownToHtmlRoute","markdown","val","html","Prism","highlightAll","keyup","index","editor","on","event","button","relatedTarget","level","text","file","stack","modal","find"],"mappings":"CAKC,SAAUA,EAAMC,GAChB,YAEsB,mBAAXC,SAAyBA,OAAOC,IAE1CD,UAAWD,GACkB,gBAAZG,SAIjBC,OAAOD,QAAUH,IAGjBD,EAAKM,SAAWL,KAEhBM,KAAM,WACP,QAASC,GAAKC,GAMb,QAASC,KACR,GAAIC,GAAQC,OAAOC,iBAAiBJ,EAAI,KAEnB,cAAjBE,EAAMG,OACTL,EAAGE,MAAMG,OAAS,OACS,SAAjBH,EAAMG,SAChBL,EAAGE,MAAMG,OAAS,cAInBL,EAAGE,MAAMI,SAAW,YAKpB,IAAIC,GAAQP,EAAGE,MAAMK,KACrBP,GAAGE,MAAMK,MAAQ,MAGjBP,EAAGQ,YAEHR,EAAGE,MAAMK,MAAQA,EAEjBE,EAAgC,SAApBP,EAAMO,UAAuBC,WAAWR,EAAMO,YAAa,EAGtEE,EADuB,gBAApBT,EAAMU,YACQF,WAAWR,EAAMW,YAAYH,WAAWR,EAAMY,gBAEhDJ,WAAWR,EAAMa,gBAAgBL,WAAWR,EAAMc,mBAGlEC,IAGD,QAASA,KACR,GAAIC,GAAclB,EAAGE,MAAMiB,OACvBC,EAAUC,SAASC,gBAAgBC,UACnCC,EAAUH,SAASI,KAAKF,SAE5BvB,GAAGE,MAAMiB,OAAS,MAElB,IAAIO,GAAY1B,EAAG2B,aAAahB,CAiBhC,IAfIF,KAAc,GAAqBiB,EAAZjB,GAC1BiB,EAAYjB,EACe,WAAvBT,EAAGE,MAAM0B,YACZ5B,EAAGE,MAAM0B,UAAY,WAEW,WAAvB5B,EAAGE,MAAM0B,YACnB5B,EAAGE,MAAM0B,UAAY,UAGtB5B,EAAGE,MAAMiB,OAASO,EAAU,KAG5BL,SAASC,gBAAgBC,UAAYH,EACrCC,SAASI,KAAKF,UAAYC,EAEtBN,IAAgBlB,EAAGE,MAAMiB,OAAQ,CACpC,GAAIU,GAAMR,SAASS,YAAY,QAC/BD,GAAIE,UAAU,oBAAoB,GAAM,GACxC/B,EAAGgC,cAAcH,IAlEnB,GAAK7B,GAAOA,EAAGiC,UAA4B,aAAhBjC,EAAGiC,WAA2BjC,EAAGkC,aAAa,oBAAzE,CAEA,GAAIzB,GACAE,CAsEA,qBAAsBX,IAAM,WAAaA,IAC5CA,EAAGmC,iBAAiB,QAASlB,GAG9Bd,OAAOgC,iBAAiB,SAAUlB,GAClCjB,EAAGmC,iBAAiB,QAASlB,GAE7BjB,EAAGmC,iBAAiB,kBAAmBlB,GAEvCjB,EAAGmC,iBAAiB,mBAAoB,SAASjC,GAChDC,OAAOiC,oBAAoB,SAAUnB,GACrCjB,EAAGoC,oBAAoB,QAASnB,GAChCjB,EAAGoC,oBAAoB,QAASnB,GAChCjB,EAAGoC,oBAAoB,oBAEvBC,OAAOC,KAAKpC,GAAOqC,QAAQ,SAASC,GACnCxC,EAAGE,MAAMsC,GAAOtC,EAAMsC,KAGvBxC,EAAGyC,gBAAgB,qBAClBC,KAAK1C,GACNmB,OAAQnB,EAAGE,MAAMiB,OACjBwB,SAAU3C,EAAGE,MAAMyC,SACnBf,UAAW5B,EAAGE,MAAM0B,UACpBtB,SAAUN,EAAGE,MAAMI,SACnBD,OAAQL,EAAGE,MAAMG,UAGlBL,EAAG4C,aAAa,oBAAoB,GACpC5C,EAAGE,MAAMyC,SAAW,SACpB3C,EAAGE,MAAM0B,UAAY,SAErB3B,KAID,MAAuC,kBAA5BE,QAAOC,iBACV,SAASyC,GACf,MAAOA,IAGD,SAASA,GAMf,MALIA,IAAYA,EAASC,OACxBC,MAAMC,UAAUT,QAAQU,KAAKJ,EAAU9C,GAC7B8C,GAAYA,EAASZ,UAC/BlC,EAAK8C,GAECA;CCxIT,SAAUrD,GACe,kBAAXC,SAAyBA,OAAOC,IAEvCD,QAAQ,UAAWD,GACM,gBAAXI,SAAuBA,OAAOD,QAE5CC,OAAOD,QAAUH,EAAQ0D,QAAQ,WAGjC1D,EAAQ2D,SAEd,SAAUC,GACR,GAAIC,MACAC,IAIJF,GAAEG,MAAQ,SAASC,EAAOC,GAyCtB,QAASC,GAAQC,GACb,GAAKN,EAAOG,GAMRH,EAAOG,GAAOI,KAAKD,OANH,CAChBN,EAAOG,KACP,IAAIK,GAAMF,GACVL,GAAWE,GAASK,GAS5B,QAASC,KACL,GAAKT,EAAOG,GAAZ,CAGA,GAAIO,GAAeV,EAAOG,GAAOQ,OACjC,IAAID,EAAc,CACd,GAAIF,GAAME,GACVT,GAAWE,GAASK,aAGbR,GAAOG,SACPF,GAAWE,IA/D1B,GAAoB,mBAATC,GACP,KAAM,mCAIV,IAAIQ,GAAWb,EAAEc,WACbC,EAAUF,EAASE,SAEvBA,GAAQC,QAAUD,EAAQE,KAC1BF,EAAQG,MAAQH,EAAQI,KACxBJ,EAAQK,SAAWL,EAAQM,MAG3B,IAAIC,GAA+B,kBAATjB,GAEtBkB,EAAiBD,EAA0C,KAA3BtB,EAAEwB,QAAO,KAAUnB,EAmBvD,OAlBAC,GAAQ,WAEJ,GAAImB,GAAQzB,EAAE0B,KAAKC,MAAM5E,QAASuE,EAAejB,IAASkB,GAa1D,OATAE,GAAMR,KAAK,WACPJ,EAASe,QAAQD,MAAMjF,KAAMmF,aAEjCJ,EAAMN,KAAK,WACPN,EAASiB,OAAOH,MAAMjF,KAAMmF,aAGhCJ,EAAMJ,OAAOX,GAENe,IAGJV,GAoCXf,EAAE+B,MAAQ,OAAQ,SAAW,SAAUC,EAAGC,GACtCjC,EAAGiC,GAAW,SAAU7B,EAAO8B,EAAKC,EAAMC,EAAUC,GAQhD,MANKrC,GAAEsC,WAAYH,KACfE,EAAOA,GAAQD,EACfA,EAAWD,EACXA,EAAOI,QAGJvC,EAAEG,MAAMC,GACXiC,KAAiB,UAAXJ,EAAqB,OAAS,MACpCC,IAAKA,EACLC,KAAMA,EACNnB,QAASoB,EACTI,SAAUH,MAKtB,IAAII,GAAiB,SAASrC,GAC1B,MAAQH,GAAOyC,eAAetC,IAAUH,EAAOG,GAAOV,OAAS,GAAMQ,EAAWwC,eAAetC,IAG/FuC,EAAoB,WACpB,IAAK,GAAIX,KAAK/B,GACV,GAAIwC,EAAeT,GAAI,OAAO,CAElC,QAAO,EAGXhC,GAAEG,MAAMyC,UAAY,SAASxC,GACzB,MAAIA,GAAcqC,EAAerC,GACrBuC,KAGhB3C,EAAEG,MAAM0C,iBAAmB,SAASzC,GAChC,IAAKA,EAAO,KAAM,+BAElB,OAAOF,GAAWE,IAGtBJ,EAAEG,MAAM2C,MAAQ,SAAS1C,GACrB,IAAKA,EAAO,KAAM,+BAElB,IAAI2C,GAAU/C,EAAEG,MAAM0C,iBAAiBzC,SAChCH,GAAOG,SACPF,GAAWE,GACd2C,GAASA,EAAQD,SAGzB9C,EAAEG,MAAM6C,MAAQ,SAAS5C,GACrB,GAAKA,EAQGH,EAAOG,KACPH,EAAOG,WARX,KAAK,GAAI4B,KAAK/B,GACNA,EAAOyC,eAAeV,KACtB/B,EAAO+B;ACrJ3BjF,OAAOkG,aAAelG,OAAOkG,iBAE7BlG,OAAOkG,aAAaC,MAAQ,WAGxBnG,OAAOkG,aAAaE,aAEvBpG,OAAOkG,aAAaG,yBACjBrG,OAAOkG,aAAaI,wBACvBtG,OAAOkG,aAAaK,sBACjBvG,OAAOkG,aAAaM,gBAOxBxG,OAAOkG,aAAaG,uBAAyB,WAEzCpD,EAAE,qBAAqBwD,UAAU,SAASC,GAItC,GAHAA,EAAEC,iBAGa,GAAXD,EAAEE,MAAY,CACd,GAAIC,GAAM7G,OAAO8G,KAAK7D,EAAEtD,MAAMyF,KAAK,QAAS,SAI5C,aAHIyB,GACAA,EAAIE,SAIZ/G,OAAOkB,SAAS8F,SAAW/D,EAAEtD,MAAMyF,KAAK,WAQhDpF,OAAOkG,aAAaI,sBAAwB,WAExC5G,SAASuD,EAAE,cAOfjD,OAAOkG,aAAae,eAAiB,SAASC,GAE1CjE,EAAEG,MAAM2C,MAAMmB,IASlBlH,OAAOkG,aAAaiB,eAAiB,SAASC,GAG1C,GAAIC,GAASpE,EAAEmE,GACXE,EAAWrE,EAAE,iCAAmCmE,EAAQG,KAAO,KAC/DC,EAAYH,EAAOI,KAAK,OAG5B9H,MAAK+H,qBAAuB,WAGiC,mBAA9C1H,QAAOkG,aAAaE,UAAUoB,IACrCG,aAAa3H,OAAOkG,aAAaE,UAAUoB,IAK/CxH,OAAOkG,aAAaE,UAAUoB,GAAaI,WAAW,WAGlD1B,aAAae,eAAeI,EAAOI,KAAK,SAGxCxE,EAAE4E,MAAML,EAAWtB,aAAa4B,qBAAsBC,SAAUV,EAAOW,OAAQ,SAAS5C,GAGpFkC,EAASW,KAAK7C,EAAK6C,MAEnBC,MAAMC,gBAEP,SAEJ,MAKPd,EAAOe,MAAMzI,KAAK+H,sBAGlB/H,KAAK+H,wBAOT1H,OAAOkG,aAAaK,oBAAsB,WAEtCtD,EAAE,+BAA+B+B,KAAK,SAASqD,EAAOjB,GAClDpH,OAAOkG,aAAaoC,OAAS,GAAItI,QAAOkG,aAAaiB,eAAeC,MAQ5EpH,OAAOkG,aAAaM,aAAe,WAG/BvD,EAAE,aAAasF,GAAG,gBAAiB,SAAUC,GAGzC,GAAIC,GAASxF,EAAEuF,EAAME,eAGjBC,EAAQF,EAAOrD,KAAK,SACpBwD,EAAOH,EAAOrD,KAAK,QACnByD,EAAOJ,EAAOrD,KAAK,QACnB0D,EAAQL,EAAOrD,KAAK,SAGpB2D,EAAQ9F,EAAEtD,KACdoJ,GAAMC,KAAK,gBAAgBf,KAAKU,EAAQ,KAAOC,GAC/CG,EAAMC,KAAK,eAAef,KAAK,kBAAoBY,EAAO,WAAaC,EAAQ,eASvF9I,OAAOkG,aAAaC","file":"admin.js","sourcesContent":["/*!\n\tAutosize 2.0.1\n\tlicense: MIT\n\thttp://www.jacklmoore.com/autosize\n*/\n(function (root, factory) {\n\t'use strict';\n\n\tif (typeof define === 'function' && define.amd) {\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine([], factory);\n\t} else if (typeof exports === 'object') {\n\t\t// Node. Does not work with strict CommonJS, but\n\t\t// only CommonJS-like environments that support module.exports,\n\t\t// like Node.\n\t\tmodule.exports = factory();\n\t} else {\n\t\t// Browser globals (root is window)\n\t\troot.autosize = factory();\n  }\n}(this, function () {\n\tfunction main(ta) {\n\t\tif (!ta || !ta.nodeName || ta.nodeName !== 'TEXTAREA' || ta.hasAttribute('data-autosize-on')) { return; }\n\n\t\tvar maxHeight;\n\t\tvar heightOffset;\n\n\t\tfunction init() {\n\t\t\tvar style = window.getComputedStyle(ta, null);\n\n\t\t\tif (style.resize === 'vertical') {\n\t\t\t\tta.style.resize = 'none';\n\t\t\t} else if (style.resize === 'both') {\n\t\t\t\tta.style.resize = 'horizontal';\n\t\t\t}\n\n\t\t\t// horizontal overflow is hidden, so break-word is necessary for handling words longer than the textarea width\n\t\t\tta.style.wordWrap = 'break-word';\n\n\t\t\t// Chrome/Safari-specific fix:\n\t\t\t// When the textarea y-overflow is hidden, Chrome/Safari doesn't reflow the text to account for the space\n\t\t\t// made available by removing the scrollbar. This workaround will cause the text to reflow.\n\t\t\tvar width = ta.style.width;\n\t\t\tta.style.width = '0px';\n\t\t\t// Force reflow:\n\t\t\t/* jshint ignore:start */\n\t\t\tta.offsetWidth;\n\t\t\t/* jshint ignore:end */\n\t\t\tta.style.width = width;\n\n\t\t\tmaxHeight = style.maxHeight !== 'none' ? parseFloat(style.maxHeight) : false;\n\t\t\t\n\t\t\tif (style.boxSizing === 'content-box') {\n\t\t\t\theightOffset = -(parseFloat(style.paddingTop)+parseFloat(style.paddingBottom));\n\t\t\t} else {\n\t\t\t\theightOffset = parseFloat(style.borderTopWidth)+parseFloat(style.borderBottomWidth);\n\t\t\t}\n\n\t\t\tadjust();\n\t\t}\n\n\t\tfunction adjust() {\n\t\t\tvar startHeight = ta.style.height;\n\t\t\tvar htmlTop = document.documentElement.scrollTop;\n\t\t\tvar bodyTop = document.body.scrollTop;\n\t\t\t\n\t\t\tta.style.height = 'auto';\n\n\t\t\tvar endHeight = ta.scrollHeight+heightOffset;\n\n\t\t\tif (maxHeight !== false && maxHeight < endHeight) {\n\t\t\t\tendHeight = maxHeight;\n\t\t\t\tif (ta.style.overflowY !== 'scroll') {\n\t\t\t\t\tta.style.overflowY = 'scroll';\n\t\t\t\t}\n\t\t\t} else if (ta.style.overflowY !== 'hidden') {\n\t\t\t\tta.style.overflowY = 'hidden';\n\t\t\t}\n\n\t\t\tta.style.height = endHeight+'px';\n\n\t\t\t// prevents scroll-position jumping\n\t\t\tdocument.documentElement.scrollTop = htmlTop;\n\t\t\tdocument.body.scrollTop = bodyTop;\n\n\t\t\tif (startHeight !== ta.style.height) {\n\t\t\t\tvar evt = document.createEvent('Event');\n\t\t\t\tevt.initEvent('autosize.resized', true, false);\n\t\t\t\tta.dispatchEvent(evt);\n\t\t\t}\n\t\t}\n\n\t\t// IE9 does not fire onpropertychange or oninput for deletions,\n\t\t// so binding to onkeyup to catch most of those events.\n\t\t// There is no way that I know of to detect something like 'cut' in IE9.\n\t\tif ('onpropertychange' in ta && 'oninput' in ta) {\n\t\t\tta.addEventListener('keyup', adjust);\n\t\t}\n\n\t\twindow.addEventListener('resize', adjust);\n\t\tta.addEventListener('input', adjust);\n\n\t\tta.addEventListener('autosize.update', adjust);\n\n\t\tta.addEventListener('autosize.destroy', function(style){\n\t\t\twindow.removeEventListener('resize', adjust);\n\t\t\tta.removeEventListener('input', adjust);\n\t\t\tta.removeEventListener('keyup', adjust);\n\t\t\tta.removeEventListener('autosize.destroy');\n\n\t\t\tObject.keys(style).forEach(function(key){\n\t\t\t\tta.style[key] = style[key];\n\t\t\t});\n\n\t\t\tta.removeAttribute('data-autosize-on');\n\t\t}.bind(ta, {\n\t\t\theight: ta.style.height,\n\t\t\toverflow: ta.style.overflow,\n\t\t\toverflowY: ta.style.overflowY,\n\t\t\twordWrap: ta.style.wordWrap,\n\t\t\tresize: ta.style.resize\n\t\t}));\n\n\t\tta.setAttribute('data-autosize-on', true);\n\t\tta.style.overflow = 'hidden';\n\t\tta.style.overflowY = 'hidden';\n\n\t\tinit();\t\t\n\t}\n\n\t// Do nothing in IE8 or lower\n\tif (typeof window.getComputedStyle !== 'function') {\n\t\treturn function(elements) {\n\t\t\treturn elements;\n\t\t};\n\t} else {\n\t\treturn function(elements) {\n\t\t\tif (elements && elements.length) {\n\t\t\t\tArray.prototype.forEach.call(elements, main);\n\t\t\t} else if (elements && elements.nodeName) {\n\t\t\t\tmain(elements);\n\t\t\t}\n\t\t\treturn elements;\n\t\t};\n\t}\n}));\n","// AjaxQ jQuery Plugin\n// Copyright (c) 2012 Foliotek Inc.\n// MIT License\n// https://github.com/Foliotek/ajaxq\n// Uses CommonJS, AMD or browser globals to create a jQuery plugin.\n\n(function (factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['jquery'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node/CommonJS\n        module.exports = factory(require('jquery'));\n    } else {\n        // Browser globals\n        factory(jQuery);\n    }\n}(function ($) {\n    var queues = {};\n    var activeReqs = {};\n\n    // Register an $.ajaxq function, which follows the $.ajax interface, but allows a queue name which will force only one request per queue to fire.\n    // opts can be the regular $.ajax settings plainObject, or a callback returning the settings object, to be evaluated just prior to the actual call to $.ajax.\n    $.ajaxq = function(qname, opts) {\n\n        if (typeof opts === \"undefined\") {\n            throw (\"AjaxQ: queue name is not provided\");\n        }\n\n        // Will return a Deferred promise object extended with success/error/callback, so that this function matches the interface of $.ajax\n        var deferred = $.Deferred(),\n            promise = deferred.promise();\n\n        promise.success = promise.done;\n        promise.error = promise.fail;\n        promise.complete = promise.always;\n\n        // Check whether options are to be evaluated at call time or not.\n        var deferredOpts = typeof opts === 'function';\n        // Create a deep copy of the arguments, and enqueue this request.\n        var clonedOptions = !deferredOpts ? $.extend(true, {}, opts) : null;\n        enqueue(function() {\n            // Send off the ajax request now that the item has been removed from the queue\n            var jqXHR = $.ajax.apply(window, [deferredOpts ? opts() : clonedOptions]);\n\n            // Notify the returned deferred object with the correct context when the jqXHR is done or fails\n            // Note that 'always' will automatically be fired once one of these are called: http://api.jquery.com/category/deferred-object/.\n            jqXHR.done(function() {\n                deferred.resolve.apply(this, arguments);\n            });\n            jqXHR.fail(function() {\n                deferred.reject.apply(this, arguments);\n            });\n\n            jqXHR.always(dequeue); // make sure to dequeue the next request AFTER the done and fail callbacks are fired\n\n            return jqXHR;\n        });\n\n        return promise;\n\n\n        // If there is no queue, create an empty one and instantly process this item.\n        // Otherwise, just add this item onto it for later processing.\n        function enqueue(cb) {\n            if (!queues[qname]) {\n                queues[qname] = [];\n                var xhr = cb();\n                activeReqs[qname] = xhr;\n            }\n            else {\n                queues[qname].push(cb);\n            }\n        }\n\n        // Remove the next callback from the queue and fire it off.\n        // If the queue was empty (this was the last item), delete it from memory so the next one can be instantly processed.\n        function dequeue() {\n            if (!queues[qname]) {\n                return;\n            }\n            var nextCallback = queues[qname].shift();\n            if (nextCallback) {\n                var xhr = nextCallback();\n                activeReqs[qname] = xhr;\n            }\n            else {\n                delete queues[qname];\n                delete activeReqs[qname];\n            }\n        }\n    };\n\n    // Register a $.postq and $.getq method to provide shortcuts for $.get and $.post\n    // Copied from jQuery source to make sure the functions share the same defaults as $.get and $.post.\n    $.each( [ \"getq\", \"postq\" ], function( i, method ) {\n        $[ method ] = function( qname, url, data, callback, type ) {\n\n            if ( $.isFunction( data ) ) {\n                type = type || callback;\n                callback = data;\n                data = undefined;\n            }\n\n            return $.ajaxq(qname, {\n                type: method === \"postq\" ? \"post\" : \"get\",\n                url: url,\n                data: data,\n                success: callback,\n                dataType: type\n            });\n        };\n    });\n\n    var isQueueRunning = function(qname) {\n        return (queues.hasOwnProperty(qname) && queues[qname].length > 0) || activeReqs.hasOwnProperty(qname);\n    };\n\n    var isAnyQueueRunning = function() {\n        for (var i in queues) {\n            if (isQueueRunning(i)) return true;\n        }\n        return false;\n    };\n\n    $.ajaxq.isRunning = function(qname) {\n        if (qname) return isQueueRunning(qname);\n        else return isAnyQueueRunning();\n    };\n\n    $.ajaxq.getActiveRequest = function(qname) {\n        if (!qname) throw (\"AjaxQ: queue name is required\");\n\n        return activeReqs[qname];\n    };\n\n    $.ajaxq.abort = function(qname) {\n        if (!qname) throw (\"AjaxQ: queue name is required\");\n        \n        var current = $.ajaxq.getActiveRequest(qname);\n        delete queues[qname];\n        delete activeReqs[qname];\n        if (current) current.abort();\n    };\n\n    $.ajaxq.clear = function(qname) {\n        if (!qname) {\n            for (var i in queues) {\n                if (queues.hasOwnProperty(i)) {\n                    queues[i] = [];\n                }\n            }\n        }\n        else {\n            if (queues[qname]) {\n                queues[qname] = [];\n            }\n        }\n    };\n\n}));\n","window.Barryvanveen = window.Barryvanveen || {};\r\n\r\nwindow.Barryvanveen.admin = function() {\r\n\r\n    // timers to keep track of ajax-calls that are scheduled\r\n    window.Barryvanveen.callTimer = [];\r\n\r\n\twindow.Barryvanveen.initClickableTableRows();\r\n    window.Barryvanveen.initAutosizeTextareas();\r\n\twindow.Barryvanveen.initMarkdownEditors();\r\n    window.Barryvanveen.initLogModal();\r\n\r\n};\r\n\r\n/**\r\n * init clickable table rows\r\n */\r\nwindow.Barryvanveen.initClickableTableRows = function() {\r\n\r\n    $('.js-clickable-row').mousedown(function(e) {\r\n        e.preventDefault();\r\n\r\n        // middle mouseclick, open in new window\r\n        if (e.which == 2) {\r\n            var win = window.open($(this).data('href'), '_blank');\r\n            if (win) {\r\n                win.focus();\r\n            }\r\n            return;\r\n        }\r\n        window.document.location = $(this).data(\"href\");\r\n    });\r\n\r\n};\r\n\r\n/**\r\n * init autosize on textareas\r\n */\r\nwindow.Barryvanveen.initAutosizeTextareas = function() {\r\n\r\n    autosize($('textarea'));\r\n\r\n};\r\n\r\n/**\r\n * cancel all posts to a named queue\r\n */\r\nwindow.Barryvanveen.abortPostQueue = function(queue) {\r\n\r\n    $.ajaxq.abort(queue);\r\n\r\n};\r\n\r\n/**\r\n * turn an element into a markdown editor\r\n *\r\n * @param element\r\n */\r\nwindow.Barryvanveen.MarkdownEditor = function(element) {\r\n\r\n    // store elements\r\n    var $input = $(element);\r\n    var $preview = $('div[data-markdown-editor-name=' + element.name + ']');\r\n    var inputname = $input.attr('name');\r\n\r\n    // update the html-preview\r\n    this.updateMarkdownEditor = function () {\r\n\r\n        // clear any timers for this inputname\r\n        if (typeof(window.Barryvanveen.callTimer[inputname]) !== \"undefined\") {\r\n            clearTimeout(window.Barryvanveen.callTimer[inputname]);\r\n        }\r\n\r\n        // start a timer for this particular input, once the timer runs out\r\n        // the html will be requested from the server\r\n        window.Barryvanveen.callTimer[inputname] = setTimeout(function() {\r\n\r\n            // abort all pending requests for this input field\r\n            Barryvanveen.abortPostQueue($input.attr('name'));\r\n\r\n            // make a new ajax post to retrieve html for this markdown\r\n            $.postq(inputname, Barryvanveen.markdownToHtmlRoute, {markdown: $input.val()}, function(data) {\r\n\r\n                // update the preview with retrieved html\r\n                $preview.html(data.html);\r\n                // use Prism for syntax highlighting in preview\r\n                Prism.highlightAll();\r\n\r\n            }, 'json');\r\n\r\n        }, 1000);\r\n\r\n    };\r\n\r\n    // update the html preview on keyUp\r\n    $input.keyup(this.updateMarkdownEditor);\r\n\r\n    // start with filling the preview\r\n    this.updateMarkdownEditor();\r\n\r\n};\r\n\r\n/**\r\n * init markdown editors\r\n */\r\nwindow.Barryvanveen.initMarkdownEditors = function() {\r\n\r\n    $('textarea.js-markdown-editor').each(function(index, element) {\r\n        window.Barryvanveen.editor = new window.Barryvanveen.MarkdownEditor(element);\r\n    });\r\n\r\n};\r\n\r\n/**\r\n * init log table\r\n */\r\nwindow.Barryvanveen.initLogModal = function() {\r\n\r\n    // handle clicks to open a bootstrap modal with full exception stack\r\n    $('#logModal').on('show.bs.modal', function (event) {\r\n\r\n        // Button that triggered the modal\r\n        var button = $(event.relatedTarget);\r\n\r\n        // Extract info from data-* attributes\r\n        var level = button.data('level');\r\n        var text = button.data('text');\r\n        var file = button.data('file');\r\n        var stack = button.data('stack');\r\n\r\n        // Update the modal's content\r\n        var modal = $(this);\r\n        modal.find('.modal-title').html(level + \": \" + text);\r\n        modal.find('.modal-body').html(\"<small>In file \" + file + \"<br><br>\" + stack + \"</small>\");\r\n\r\n    });\r\n\r\n};\r\n\r\n/**\r\n * start scripts\r\n */\r\nwindow.Barryvanveen.admin();"],"sourceRoot":"/source/"}